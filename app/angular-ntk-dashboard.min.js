"use strict";angular.module("admin",["ngRoute","admin.dashboard","ngAnimate"]).config(["$locationProvider","$routeProvider",function(o,r){o.hashPrefix("!"),r.when("/",{redirectTo:"/home"}).when("/home",{}).when("/dashboard",{templateUrl:"dashboard/dashboard.html",controller:"DashboardViewCtrl"}).otherwise({templateUrl:"template/404.html"})}]).config(["$logProvider",function(o){o.debugEnabled(!0)}]).controller("AppCtrl",["$rootScope","$scope","$location","$window","$http","$timeout","$interval",function(e,o,a,r,t,n,i){e.system={currentTime:moment().locale("pt-br").format("L LTS"),currency:"R$",apiURL:""},e.$on("$locationChangeStart",function(o,r){a.path("/dashboard"),e.system.currentTime=moment().locale("pt-br").format("L LTS"),$(".modal-backdrop").remove(),toastr.clear()}),e.converteGatePrice=function(o,r){try{if(isNaN(o))throw"isNaN";var e=(o/100).toFixed(2).split(".");return e[0]=e[0].split(/(?=(?:...)*$)/).join("."),e.join(",")}catch(o){return""}},e.converteDocumento=function(r){try{var o=goodString(r);return 11==(o=o.replace(/\D/g,"")).length?o=(o=(o=o.replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d{1,2})$/,"$1-$2"):14==o.length?o=(o=(o=(o=o.replace(/(\d{2})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1/$2")).replace(/(\d{4})(\d{1,2})$/,"$1-$2"):goodString(r)}catch(o){return r}},e.converteTelefone=function(r){try{var o=goodString(r);return 10==(o=r.replace(/\D/g,"")).length?o=(o=o.replace(/(\d{2})(\d)/,"($1) $2")).replace(/(\d{4})(\d)/,"$1-$2"):11==o.length?o=(o=o.replace(/(\d{2})(\d)/,"($1) $2")).replace(/(\d{5})(\d)/,"$1-$2"):goodString(r)}catch(o){return r}},e.padZero=function(o,r){return Array(Math.max(r-String(o).length+1,0)).join(0)+o},e.moment=function(o){return null==o?"":moment(o).locale("pt-br").format("L LTS")},e.momentDate=function(o){return null==o?"":moment(o).format("DD/MM/YYYY")}}]).factory("focus",["$timeout","$window",function(e,a){return function(o){var r=a.document.getElementById(o);r&&r.focus(),e(function(){r&&r.focus()},500)}}]).directive("eventFocus",["focus",function(a){return function(o,r,e){r.on(e.eventFocus,function(){a(e.eventFocusId)}),o.$on("$destroy",function(){r.off(e.eventFocus)})}}]).filter("sumByKey",function(){return function(o,r){if(void 0===o||void 0===r)return 0;for(var e=0,a=o.length-1;0<=a;a--)e+=parseInt(o[a][r]);return e}});var nodeAuthenticateURL="/api/authenticate";angular.module("admin.dashboard",["ngRoute","chart.js","admin.services.dashboard"]).controller("DashboardViewCtrl",["$log","$rootScope","$scope","dashboardService","$timeout",function(o,r,e,a,t){o.debug("-- DashboardViewCtrl LOADED"),e._isLoadingPagetrTrConciliadas=!1,e._isLoadingPageTrNaoConciliadas=!1,e._isLoadingPageTrEDI=!1,e._isLoadingPageTrAdquirentesTipo=!1;var n="4828321,4828322,4828323,4828324,4828326,4828327,4828328,4828331,4828334,4828335,4828336,4828337,4828339,4828340,4828341,4828342,4828343,4828347";e.trConciliadas=[],e.trNaoConciliadas=[],e.trEDI=[],e.trAdquirentesTipo=[],e.load=function(){e._isLoadingPageTrNaoConciliadas=!0,a.getTransactions(2,n).then(function(o){e.trNaoConciliadas=o},function(o){toastr.error("Erro ao carregar as transacoes nao conciliadas"),console.error("Erro ao carregar as transacoes nao conciliadas")}).finally(function(){e._isLoadingPageTrNaoConciliadas=!1,t(function(){e._isLoadingPagetrTrConciliadas=!0,a.getTransactions(1,n).then(function(o){e.trConciliadas=o},function(o){toastr.error("Erro ao carregar as transacoes conciliadas"),console.error("Erro ao carregar as transacoes conciliadas")}).finally(function(){e._isLoadingPagetrTrConciliadas=!1,t(function(){e._isLoadingPageTrEDI=!0,a.getTransactions(1,n).then(function(o){e.trEDI=o},function(o){toastr.error("Erro ao carregar as transacoes EDI"),console.error("Erro ao carregar as transacoes EDI")}).finally(function(){e._isLoadingPageTrEDI=!1,t(function(){e._isLoadingPageTrAdquirentesTipo=!0,a.getTrAdquirentesTipo(n).then(function(o){e.trAdquirentesTipo=o},function(o){toastr.error("Erro ao carregar as transacoes adquirentes e tipo"),console.error("Erro ao carregar as transacoes adquirentes e tipo")}).finally(function(){e._isLoadingPageTrAdquirentesTipo=!1})},2e3)})},2e3)})},2e3)})};var i=function(){o.debug("* status polling STARTED"),e.load(),setTimeout(function(){"function"==typeof i&&i()},3e4)};i(),e.$on("$destroy",function(){i=null}),e.getDashboardInfo=function(o){alert("Periodo -> "+o)}}]),angular.module("admin.services.dashboard",[]).service("dashboardService",["$log","$http","$q","$window",function(n,i,c,o){return n.debug("- DashboardService LOADED"),{getTransactions:function(o,r){n.debug("getTransactions type --\x3e "+o);var e=moment().subtract(30,"days").format("YYYY-MM-DD"),a=moment().format("YYYY-MM-DD"),t=c.defer();return i({method:"GET",url:"http://payreportdemo.ntk.com.br:53680/api/AutoCom/GetTransacaoConciliacaoPorTecnologia",headers:{Authorization:"Basic dmljdG9yLmR1YXJ0ZUBudGsuY29tLmJyOnZpY3Rvcg=="},params:{pessoaId:"3504",tecnologiaId:r,tecnologiaTipoId:"3,4",dataIni:e,dataFim:a,conciliada:o}}).then(function(o){t.resolve(o.data)},function(o){t.reject(o)}),t.promise},getTrAdquirentesTipo:function(o){n.debug("getTrAdquirentesTipo");var r=moment().subtract(30,"days").format("YYYY-MM-DD"),e=moment().format("YYYY-MM-DD"),a=c.defer();return i({method:"GET",url:"http://payreportdemo.ntk.com.br:53680/api/AutoCom/GetTransacaoPorTipo",headers:{Authorization:"Basic dmljdG9yLmR1YXJ0ZUBudGsuY29tLmJyOnZpY3Rvcg=="},params:{pessoaId:"3504",tecnologiaId:o,dataIni:r,dataFim:e}}).then(function(o){a.resolve(o.data)},function(o){a.reject(o)}),a.promise}}}]);