"use strict";angular.module("admin",["ngRoute","admin.dashboard","ngAnimate"]).config(["$locationProvider","$routeProvider",function(o,r){o.hashPrefix("!"),r.when("/",{redirectTo:"/home"}).when("/home",{}).when("/dashboard",{templateUrl:"dashboard/dashboard.html",controller:"DashboardViewCtrl"}).otherwise({templateUrl:"template/404.html"})}]).config(["$logProvider",function(o){o.debugEnabled(!0)}]).controller("AppCtrl",["$rootScope","$scope","$location","$window","$http","$timeout","$interval",function(a,o,e,r,t,n,i){a.system={currentTime:moment().locale("pt-br").format("L LTS"),currency:"R$",apiURL:""},a.$on("$locationChangeStart",function(o,r){e.path("/dashboard"),a.system.currentTime=moment().locale("pt-br").format("L LTS"),$(".modal-backdrop").remove(),toastr.clear()}),a.converteGatePrice=function(o,r){try{if(isNaN(o))throw"isNaN";var a=(o/100).toFixed(2).split(".");return a[0]=a[0].split(/(?=(?:...)*$)/).join("."),a.join(",")}catch(o){return""}},a.converteDocumento=function(r){try{var o=goodString(r);return 11==(o=o.replace(/\D/g,"")).length?o=(o=(o=o.replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d{1,2})$/,"$1-$2"):14==o.length?o=(o=(o=(o=o.replace(/(\d{2})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1/$2")).replace(/(\d{4})(\d{1,2})$/,"$1-$2"):goodString(r)}catch(o){return r}},a.converteTelefone=function(r){try{var o=goodString(r);return 10==(o=r.replace(/\D/g,"")).length?o=(o=o.replace(/(\d{2})(\d)/,"($1) $2")).replace(/(\d{4})(\d)/,"$1-$2"):11==o.length?o=(o=o.replace(/(\d{2})(\d)/,"($1) $2")).replace(/(\d{5})(\d)/,"$1-$2"):goodString(r)}catch(o){return r}},a.padZero=function(o,r){return Array(Math.max(r-String(o).length+1,0)).join(0)+o},a.moment=function(o){return null==o?"":moment(o).locale("pt-br").format("L LTS")},a.momentDate=function(o){return null==o?"":moment(o).format("DD/MM/YYYY")}}]).factory("focus",["$timeout","$window",function(a,e){return function(o){var r=e.document.getElementById(o);r&&r.focus(),a(function(){r&&r.focus()},500)}}]).directive("eventFocus",["focus",function(e){return function(o,r,a){r.on(a.eventFocus,function(){e(a.eventFocusId)}),o.$on("$destroy",function(){r.off(a.eventFocus)})}}]).filter("sumByKey",function(){return function(o,r){if(void 0===o||void 0===r)return 0;for(var a=0,e=o.length-1;0<=e;e--)a+=parseInt(o[e][r]);return a}});var nodeAuthenticateURL="/api/authenticate";angular.module("admin.dashboard",["ngRoute","chart.js","admin.services.dashboard"]).controller("DashboardViewCtrl",["$log","$rootScope","$scope","dashboardService","$timeout",function(o,r,a,e,t){o.debug("-- DashboardViewCtrl LOADED"),a._isLoadingPagetrTrConciliadas=!1,a._isLoadingPageTrNaoConciliadas=!1,a._isLoadingPageTrEDI=!1,a._isLoadingPageTrAdquirentesTipo=!1;var n="4828321, 4828322, 4828323, 4828324, 4828326, 4828331, 4828334,4828335, 4828339, 4828342,4828336, 4828341,4828337, 4828340, 4828343,4828328,4828347, 4828331,4828350, 4828352, 4828351,4828353";a.trConciliadas=[],a.trNaoConciliadas=[],a.trEDI=[],a.trAdquirentesTipo=[],a.load=function(){a._isLoadingPageTrNaoConciliadas=!0,e.getTransactions(2,n).then(function(o){a.trNaoConciliadas=o},function(o){toastr.error("Erro ao carregar as transacoes nao conciliadas"),console.error("Erro ao carregar as transacoes nao conciliadas")}).finally(function(){a._isLoadingPageTrNaoConciliadas=!1,t(function(){a._isLoadingPagetrTrConciliadas=!0,e.getTransactions(1,n).then(function(o){a.trConciliadas=o},function(o){toastr.error("Erro ao carregar as transacoes conciliadas"),console.error("Erro ao carregar as transacoes conciliadas")}).finally(function(){a._isLoadingPagetrTrConciliadas=!1,t(function(){a._isLoadingPageTrEDI=!0,e.getTransactions(1,"48283").then(function(o){a.trEDI=o},function(o){toastr.error("Erro ao carregar as transacoes EDI"),console.error("Erro ao carregar as transacoes EDI")}).finally(function(){a._isLoadingPageTrEDI=!1,t(function(){a._isLoadingPageTrAdquirentesTipo=!0,e.getTrAdquirentesTipo(n).then(function(o){a.trAdquirentesTipo=o},function(o){toastr.error("Erro ao carregar as transacoes adquirentes e tipo"),console.error("Erro ao carregar as transacoes adquirentes e tipo")}).finally(function(){a._isLoadingPageTrAdquirentesTipo=!1})},2e3)})},2e3)})},2e3)})};var i=function(){o.debug("* status polling STARTED"),a.load(),setTimeout(function(){"function"==typeof i&&i()},3e4)};i(),a.$on("$destroy",function(){i=null}),a.getDashboardInfo=function(o){alert("Periodo -> "+o)}}]),angular.module("admin.services.dashboard",[]).service("dashboardService",["$log","$http","$q","$window",function(e,t,n,o){return e.debug("- DashboardService LOADED"),{getTransactions:function(o,r){e.debug("getTransactions type --\x3e "+o);moment().subtract(30,"days").format("YYYY-MM-DD"),moment().format("YYYY-MM-DD");var a=n.defer();return t({method:"GET",url:"http://api.payreport.com.br/api/AutoCom/GetTransacaoConciliacaoPorTecnologia",headers:{Authorization:"Basic dmljdG9yLmR1YXJ0ZUBudGsuY29tLmJyOnZpY3Rvcg=="},params:{pessoaId:"3504",tecnologiaId:r,tecnologiaTipoId:"3,4",dataIni:"2018-03-01",dataFim:"2018-04-06",conciliada:o}}).then(function(o){a.resolve(o.data)},function(o){a.reject(o)}),a.promise},getTrAdquirentesTipo:function(o){e.debug("getTrAdquirentesTipo");moment().subtract(30,"days").format("YYYY-MM-DD"),moment().format("YYYY-MM-DD");var r=n.defer();return t({method:"GET",url:"http://api.payreport.com.br/api/AutoCom/GetTransacaoPorTipo",headers:{Authorization:"Basic dmljdG9yLmR1YXJ0ZUBudGsuY29tLmJyOnZpY3Rvcg=="},params:{pessoaId:"3504",tecnologiaId:o,dataIni:"2018-03-01",dataFim:"2018-04-06"}}).then(function(o){r.resolve(o.data)},function(o){r.reject(o)}),r.promise}}}]);