"use strict";angular.module("admin",["ngRoute","admin.dashboard","ngAnimate"]).config(["$locationProvider","$routeProvider",function(o,a){o.hashPrefix("!"),a.when("/",{redirectTo:"/home"}).when("/home",{}).when("/dashboard",{templateUrl:"dashboard/dashboard.html",controller:"DashboardViewCtrl"}).otherwise({templateUrl:"template/404.html"})}]).config(["$logProvider",function(o){o.debugEnabled(!0)}]).controller("AppCtrl",["$rootScope","$scope","$location","$window","$http","$timeout","$interval",function(r,o,e,a,t,n,i){r.system={currentTime:moment().locale("pt-br").format("L LTS"),currency:"R$",apiURL:""},r.$on("$locationChangeStart",function(o,a){e.path("/dashboard"),r.system.currentTime=moment().locale("pt-br").format("L LTS"),$(".modal-backdrop").remove(),toastr.clear()}),r.converteGatePrice=function(o,a){try{if(isNaN(o))throw"isNaN";var r=(o/100).toFixed(2).split(".");return r[0]=r[0].split(/(?=(?:...)*$)/).join("."),r.join(",")}catch(o){return""}},r.converteDocumento=function(a){try{var o=goodString(a);return 11==(o=o.replace(/\D/g,"")).length?o=(o=(o=o.replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d{1,2})$/,"$1-$2"):14==o.length?o=(o=(o=(o=o.replace(/(\d{2})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1.$2")).replace(/(\d{3})(\d)/,"$1/$2")).replace(/(\d{4})(\d{1,2})$/,"$1-$2"):goodString(a)}catch(o){return a}},r.converteTelefone=function(a){try{var o=goodString(a);return 10==(o=a.replace(/\D/g,"")).length?o=(o=o.replace(/(\d{2})(\d)/,"($1) $2")).replace(/(\d{4})(\d)/,"$1-$2"):11==o.length?o=(o=o.replace(/(\d{2})(\d)/,"($1) $2")).replace(/(\d{5})(\d)/,"$1-$2"):goodString(a)}catch(o){return a}},r.padZero=function(o,a){return Array(Math.max(a-String(o).length+1,0)).join(0)+o},r.moment=function(o){return null==o?"":moment(o).locale("pt-br").format("L LTS")},r.momentDate=function(o){return null==o?"":moment(o).format("DD/MM/YYYY")}}]).factory("focus",["$timeout","$window",function(r,e){return function(o){var a=e.document.getElementById(o);a&&a.focus(),r(function(){a&&a.focus()},500)}}]).directive("eventFocus",["focus",function(e){return function(o,a,r){a.on(r.eventFocus,function(){e(r.eventFocusId)}),o.$on("$destroy",function(){a.off(r.eventFocus)})}}]).filter("sumByKey",function(){return function(o,a){if(void 0===o||void 0===a)return 0;for(var r=0,e=o.length-1;0<=e;e--)r+=parseInt(o[e][a]);return r}});var nodeAuthenticateURL="/api/authenticate";angular.module("admin.dashboard",["ngRoute","chart.js","admin.services.dashboard"]).controller("DashboardViewCtrl",["$log","$rootScope","$scope","dashboardService","$timeout",function(o,a,e,r,t){o.debug("-- DashboardViewCtrl LOADED"),e._isLoadingPagetrTrConciliadas=!1,e._isLoadingPageTrNaoConciliadas=!1,e._isLoadingPageTrEDI=!1,e._isLoadingPageTrAdquirentesTipo=!1;var n="4828321,4828322,4828323,4828324,4828326,4828327,4828328,4828331,4828334,4828335,4828336,4828337,4828339,4828340,4828341,4828342,4828343,4828347";function i(){var a=[],r=[];a.push(""),r.push(""),e.trAdquirentesTipo.forEach(function(o){a.push(o.operacao_Nome),r.push(parseFloat(o.valorBruto_Total))});var o=google.visualization.arrayToDataTable([a,r]);new google.visualization.BarChart(document.getElementById("chart_div")).draw(o,{title:"Transacao por Tipo",chartArea:{width:"50%"}})}e.trConciliadas=[],e.trNaoConciliadas=[],e.trEDI=[],e.trAdquirentesTipo=[],google.charts.load("current",{packages:["corechart","bar"]}),google.charts.setOnLoadCallback(i),e.load=function(){e._isLoadingPageTrNaoConciliadas=!0,r.getTransactions(2,n).then(function(o){e.trNaoConciliadas=o},function(o){toastr.error("Erro ao carregar as transacoes nao conciliadas"),console.error("Erro ao carregar as transacoes nao conciliadas")}).finally(function(){e._isLoadingPageTrNaoConciliadas=!1,t(function(){e._isLoadingPagetrTrConciliadas=!0,r.getTransactions(1,n).then(function(o){e.trConciliadas=o},function(o){toastr.error("Erro ao carregar as transacoes conciliadas"),console.error("Erro ao carregar as transacoes conciliadas")}).finally(function(){e._isLoadingPagetrTrConciliadas=!1,t(function(){e._isLoadingPageTrEDI=!0,r.getTransactions(1,"48283").then(function(o){e.trEDI=o},function(o){toastr.error("Erro ao carregar as transacoes EDI"),console.error("Erro ao carregar as transacoes EDI")}).finally(function(){e._isLoadingPageTrEDI=!1,t(function(){e._isLoadingPageTrAdquirentesTipo=!0,r.getTrAdquirentesTipo(n).then(function(o){e.trAdquirentesTipo=o},function(o){toastr.error("Erro ao carregar as transacoes adquirentes e tipo"),console.error("Erro ao carregar as transacoes adquirentes e tipo")}).finally(function(){e._isLoadingPageTrAdquirentesTipo=!1,i()})},2e3)})},2e3)})},2e3)})};var c=function(){o.debug("* status polling STARTED"),e.load(),setTimeout(function(){"function"==typeof c&&c()},3e4)};c(),e.$on("$destroy",function(){c=null}),e.enabledGraphic=!0,e.sendEnabledGraphic=function(){e.enabledGraphic=!e.enabledGraphic}}]),angular.module("admin.services.dashboard",[]).service("dashboardService",["$log","$http","$q","$window",function(e,t,n,o){return e.debug("- DashboardService LOADED"),{getTransactions:function(o,a){e.debug("getTransactions type --\x3e "+o);moment().subtract(30,"days").format("YYYY-MM-DD"),moment().format("YYYY-MM-DD");var r=n.defer();return t({method:"GET",url:"http://api.payreport.com.br/api/AutoCom/GetTransacaoConciliacaoPorTecnologia",headers:{Authorization:"Basic dmljdG9yLmR1YXJ0ZUBudGsuY29tLmJyOnZpY3Rvcg=="},params:{pessoaId:"3504",tecnologiaId:a,tecnologiaTipoId:"3,4",dataIni:"2018-03-01",dataFim:"2018-04-06",conciliada:o}}).then(function(o){r.resolve(o.data)},function(o){r.reject(o)}),r.promise},getTrAdquirentesTipo:function(o){e.debug("getTrAdquirentesTipo");moment().subtract(30,"days").format("YYYY-MM-DD"),moment().format("YYYY-MM-DD");var a=n.defer();return t({method:"GET",url:"http://api.payreport.com.br/api/AutoCom/GetTransacaoPorTipo",headers:{Authorization:"Basic dmljdG9yLmR1YXJ0ZUBudGsuY29tLmJyOnZpY3Rvcg=="},params:{pessoaId:"3504",tecnologiaId:o,dataIni:"2018-03-01",dataFim:"2018-04-06"}}).then(function(o){a.resolve(o.data)},function(o){a.reject(o)}),a.promise}}}]);